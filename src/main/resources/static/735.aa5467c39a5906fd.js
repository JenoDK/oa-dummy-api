"use strict";(self.webpackChunkagilent_angular_playground=self.webpackChunkagilent_angular_playground||[]).push([[735],{3735:(Y,g,s)=>{s.r(g),s.d(g,{InjectionModule:()=>Q});var u=s(6895),r=s(5878),h=s(7726),n=s(4650),j=s(1296),f=s(181),C=s(8274),v=s(7217),b=s(947);let I=(()=>{class e{constructor(i,t,o){this.configService=i,this.authenticationService=t,this.olssCallService=o,this.instrumentsResultSubject=new f.t,this.errorMessageSubject=new f.t,this.instrumentResult=this.instrumentsResultSubject,this.errorMessage=this.errorMessageSubject}getInstruments(){this.authenticationService.isLoggedIn()||this.authenticationService.logout();let t={apiUrl:this.configService.data.olss_api_url,connectionTimeout:this.configService.data.olss_api_connectionTimeout_millis,token:this.authenticationService.getToken()};this.olssCallService.executeOlssCall(t,"/v2.0/instruments").subscribe(o=>this.instrumentsResultSubject.next(o),o=>{this.errorMessageSubject.next(401===o.status?JSON.parse(o.error).details:o.message)})}}return e.\u0275fac=function(i){return new(i||e)(n.LFG(C._Z),n.LFG(v.$),n.LFG(b.Y))},e.\u0275prov=n.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();var S=s(6021),M=s(9889),F=s(529);let w=(()=>{class e{constructor(i){this.http=i}submitInjection(i){return this.http.post("/injection",i,{}).pipe((0,M.K)(t=>(0,S._)(t))).toPromise()}}return e.\u0275fac=function(i){return new(i||e)(n.LFG(F.eN))},e.\u0275prov=n.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();var _=s(1369),m=s(8969),c=s(4006);const A=["injectionForm"];function Z(e,l){if(1&e){const i=n.EpF();n.TgZ(0,"div",15)(1,"div",16)(2,"div",5)(3,"ag-input",23),n.NdJ("ngModelChange",function(o){n.CHM(i);const a=n.oxw();return n.KtG(a.amountOfInjections=o)}),n.ALo(4,"translate"),n.qZA()()()()}if(2&e){const i=n.oxw(),t=n.MAs(2);n.xp6(2),n.Q6J("ngClass",i.buildFormCssClass()+" fixed-label-width"),n.xp6(1),n.s9C("label",n.lcZ(4,8,"module.injection.amountOfInjections")),n.Q6J("required",!0)("valueType",i.InputTypeEnum.NUMBER)("precision",0)("min",0)("ngModel",i.amountOfInjections)("form",t)}}const y=function(e){return{number:e}};function T(e,l){if(1&e){const i=n.EpF();n.TgZ(0,"div",7)(1,"div",5)(2,"ag-input",24),n.NdJ("ngModelChange",function(o){const d=n.CHM(i).$implicit;return n.KtG(d.value=o)}),n.ALo(3,"translate"),n.qZA()()()}if(2&e){const i=l.$implicit,t=n.oxw(),o=n.MAs(2);n.xp6(1),n.Q6J("ngClass",t.buildFormCssClass()+" fixed-label-width"),n.xp6(1),n.s9C("label",n.xi3(3,10,"module.injection.target",n.VKq(13,y,i.id))),n.MGl("name","target",i.value,""),n.Q6J("required",!0)("valueType",t.InputTypeEnum.NUMBER)("min",0)("precision",0)("labelPosition","top")("ngModel",i.value)("form",o)}}const J=function(e){return{remaining:e}};function x(e,l){if(1&e&&(n.TgZ(0,"div",25)(1,"div",16)(2,"p"),n._uU(3),n.ALo(4,"translate"),n.qZA()()()),2&e){const i=n.oxw();n.xp6(3),n.Oqu(n.xi3(4,1,"module.injection.remainingInjections",n.VKq(4,J,i.getRemainingInjections())))}}let O=(()=>{class e{constructor(i,t,o,a,d,R){this.olssInstrumentService=i,this.authenticationService=t,this.injectionService=o,this.workflowService=a,this.translateService=d,this.notificationService=R,this.InputTypeEnum=r.n$I,this.injection={sample_name:null,instrument:null,workflow:null,vial:null,single_injection:!1,targets:[{id:1,value:null},{id:2,value:null},{id:3,value:null},{id:4,value:null},{id:5,value:null}]},this.labelPosition="left",this.formDensity="Low",this.showAmountOfInjections=!1,this.processedInjections=0,this.instrumentResult=this.olssInstrumentService.instrumentResult.pipe((0,j.U)(q=>q.instruments))}ngOnInit(){this.olssInstrumentService.getInstruments(),this.workflows=this.workflowService.findAll()}buildFormCssClass(){return`awf-form-${this.formDensity.toLowerCase()}-density injection-form`}clickSubmit(){if(this.injectionForm.onSubmit(null),this.injectionForm.valid){if(this.useAmountOfInjections()&&(++this.processedInjections,0==this.getRemainingInjections()))return void this.authenticationService.logout();this.injectionService.submitInjection(this.injection).then(i=>{this.translateService.get("module.injection.submitSuccessMessage").subscribe(t=>this.notificationService.success(t))}).catch(i=>{let t;t=i.error?i.error:i.message,this.translateService.get("error").subscribe(o=>this.notificationService.error(t,o))})}}clearValues(){this.injection={sample_name:null,instrument:null,workflow:null,vial:null,single_injection:!1,targets:[{id:1,value:null},{id:2,value:null},{id:3,value:null},{id:4,value:null},{id:5,value:null}]},this.amountOfInjections=null,this.processedInjections=0}getRemainingInjections(){return this.useAmountOfInjections()?this.amountOfInjections-this.processedInjections:0}useAmountOfInjections(){return this.showAmountOfInjections&&this.amountOfInjections}}return e.\u0275fac=function(i){return new(i||e)(n.Y36(I),n.Y36(v.$),n.Y36(w),n.Y36(_.z),n.Y36(m.sK),n.Y36(r.gqp))},e.\u0275cmp=n.Xpm({type:e,selectors:[["app-submit-injection-form"]],viewQuery:function(i,t){if(1&i&&n.Gf(A,5),2&i){let o;n.iGM(o=n.CRH())&&(t.injectionForm=o.first)}},decls:38,vars:57,consts:[[1,"container-fluid"],["injectionForm","ngForm"],["class","row mt-1",4,"ngIf"],[1,"row","mt-2"],[1,"col-xl-8"],[3,"ngClass"],["name","sample_name",3,"label","required","labelPosition","ngModel","form","ngModelChange"],[1,"col-xl-2"],["name","vial",3,"label","required","valueType","precision","min","labelPosition","ngModel","form","ngModelChange"],[1,"row","mt-3"],[1,"col-xl-10"],["bindProperty","name","name","workflow",3,"label","required","labelPosition","values","ngModel","form","ngModelChange"],["bindProperty","name","name","instrument",3,"label","required","labelPosition","values","ngModel","form","ngModelChange"],[1,"row","mt-3","justify-content-start"],["class","col-xl-2",4,"ngFor","ngForOf"],[1,"row","mt-1"],[1,"col-xl-3"],["name","single_injection",3,"label","ngModel","ngModelChange"],["class","row",4,"ngIf"],[1,"row","mt-4","justify-content-start"],["id","btn-grp-2"],["id","submit","type","primary",3,"value","click"],["id","clear","type","secondary",3,"value","tooltipContent","click"],["name","amountOfInjections",3,"label","required","valueType","precision","min","ngModel","form","ngModelChange"],[3,"label","required","valueType","min","precision","labelPosition","ngModel","name","form","ngModelChange"],[1,"row"]],template:function(i,t){if(1&i&&(n.TgZ(0,"div",0)(1,"form",null,1),n.YNc(3,Z,5,10,"div",2),n.TgZ(4,"div",3)(5,"div",4)(6,"div",5)(7,"ag-input",6),n.NdJ("ngModelChange",function(a){return t.injection.sample_name=a}),n.ALo(8,"translate"),n.qZA()()(),n.TgZ(9,"div",7)(10,"div",5)(11,"ag-input",8),n.NdJ("ngModelChange",function(a){return t.injection.vial=a}),n.ALo(12,"translate"),n.qZA()()()(),n.TgZ(13,"div",9)(14,"div",10)(15,"div",5)(16,"ag-select",11),n.NdJ("ngModelChange",function(a){return t.injection.workflow=a}),n.ALo(17,"translate"),n.ALo(18,"async"),n.qZA(),n.TgZ(19,"ag-select",12),n.NdJ("ngModelChange",function(a){return t.injection.instrument=a}),n.ALo(20,"translate"),n.ALo(21,"async"),n.qZA()()()(),n.TgZ(22,"div",13),n.YNc(23,T,4,15,"div",14),n.qZA(),n.TgZ(24,"div",15)(25,"div",16)(26,"div",5)(27,"ag-checkbox",17),n.NdJ("ngModelChange",function(a){return t.injection.single_injection=a}),n.ALo(28,"translate"),n.qZA()()()(),n.YNc(29,x,5,6,"div",18),n.TgZ(30,"div",19)(31,"div",10)(32,"ag-button-group",20)(33,"awf-button-ng",21),n.NdJ("click",function(){return t.clickSubmit()}),n.ALo(34,"translate"),n.qZA(),n.TgZ(35,"awf-button-ng",22),n.NdJ("click",function(){return t.clearValues()}),n.ALo(36,"translate"),n.ALo(37,"translate"),n.qZA()()()()()()),2&i){const o=n.MAs(2);n.xp6(3),n.Q6J("ngIf",t.showAmountOfInjections),n.xp6(3),n.Q6J("ngClass",t.buildFormCssClass()+" fixed-label-width"),n.xp6(1),n.s9C("label",n.lcZ(8,37,"module.injection.sampleName")),n.Q6J("required",!0)("labelPosition",t.labelPosition)("ngModel",t.injection.sample_name)("form",o),n.xp6(3),n.Q6J("ngClass",t.buildFormCssClass()),n.xp6(1),n.s9C("label",n.lcZ(12,39,"module.injection.vial")),n.Q6J("required",!0)("valueType",t.InputTypeEnum.NUMBER)("precision",0)("min",0)("labelPosition",t.labelPosition)("ngModel",t.injection.vial)("form",o),n.xp6(4),n.Q6J("ngClass",t.buildFormCssClass()+" fixed-label-width"),n.xp6(1),n.s9C("label",n.lcZ(17,41,"module.injection.workflow")),n.Q6J("required",!0)("labelPosition",t.labelPosition)("values",n.lcZ(18,43,t.workflows))("ngModel",t.injection.workflow)("form",o),n.xp6(3),n.s9C("label",n.lcZ(20,45,"module.injection.instrument")),n.Q6J("required",!0)("labelPosition",t.labelPosition)("values",n.lcZ(21,47,t.instrumentResult))("ngModel",t.injection.instrument)("form",o),n.xp6(4),n.Q6J("ngForOf",t.injection.targets),n.xp6(3),n.Q6J("ngClass",t.buildFormCssClass()+" fixed-label-width"),n.xp6(1),n.s9C("label",n.lcZ(28,49,"module.injection.singleInjection")),n.Q6J("ngModel",t.injection.single_injection),n.xp6(2),n.Q6J("ngIf",t.showAmountOfInjections),n.xp6(4),n.s9C("value",n.lcZ(34,51,"module.injection.submit")),n.xp6(2),n.s9C("value",n.lcZ(36,53,"clearValues")),n.s9C("tooltipContent",n.lcZ(37,55,"clearValuesDescription"))}},dependencies:[u.mk,u.sg,u.O5,r.amK,r.Hr0,r.bK4,c._Y,c.JJ,c.JL,c.Q7,c.On,c.F,r.r0F,r.KbJ,u.Ov,m.X$],styles:[".injection-form.fixed-label-width[_ngcontent-%COMP%]{--ag-label-width: 230px }"]}),e})();const L=[{path:"",component:(()=>{class e{constructor(){this.actions=[]}}return e.\u0275fac=function(i){return new(i||e)},e.\u0275cmp=n.Xpm({type:e,selectors:[["app-injection"]],decls:6,vars:3,consts:[["slot","title-bar"],["slot","titleBarName"],["slot","titleBarActions"]],template:function(i,t){1&i&&(n.TgZ(0,"ag-title-bar",0)(1,"h1",1),n._uU(2),n.ALo(3,"translate"),n.qZA(),n._UZ(4,"div",2),n.qZA(),n._UZ(5,"app-submit-injection-form")),2&i&&(n.xp6(2),n.Oqu(n.lcZ(3,1,"title.injectionModule")))},dependencies:[r.GN3,O,m.X$]}),e})(),children:[]}];let N=(()=>{class e{}return e.\u0275fac=function(i){return new(i||e)},e.\u0275mod=n.oAB({type:e}),e.\u0275inj=n.cJS({imports:[h.Bz.forChild(L)]}),e})();var P=s(9019);let Q=(()=>{class e{}return e.\u0275fac=function(i){return new(i||e)},e.\u0275mod=n.oAB({type:e}),e.\u0275inj=n.cJS({imports:[u.ez,r.gPf,r.Anc,r.b89,r.Lqp,r.ZU7,r.q6q,r.nDK,N,c.u5,r.hJ1,P.KI,r.xuJ]}),e})()}}]);